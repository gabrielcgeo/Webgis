{% extends 'layout.html' %}
{% block title %}Templates de Relatório Geográfico - {{ company.name }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h2 mb-1">
                        <i class="fas fa-layer-group text-primary me-2"></i>
                        Templates de Relatório Geográfico
                    </h1>
                    <p class="text-muted mb-0">Escolha um template e personalize-o com seus dados e conteúdo</p>
                </div>
                <div class="d-flex gap-2">
                    <a href="{{ url_for('geographic_report') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Voltar
                    </a>
                    <button class="btn btn-primary" onclick="showTemplateBuilder()">
                        <i class="fas fa-magic me-2"></i>Construtor de Template
                    </button>
                    <button class="btn btn-info" onclick="testPreview()">
                        <i class="fas fa-bug me-2"></i>Testar Preview
                    </button>
                    <button class="btn btn-warning" onclick="testSimpleModal()">
                        <i class="fas fa-exclamation-triangle me-2"></i>Testar Modal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Filtros de Template -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <select class="form-select" id="category-filter">
                                <option value="">Todas as Categorias</option>
                                <option value="story-focused">História como Foco</option>
                                <option value="map-focused">Mapa como Foco</option>
                                <option value="balanced">Equilibrado</option>
                                <option value="business">Negócios</option>
                                <option value="education">Educação</option>
                                <option value="tourism">Turismo</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="layout-filter">
                                <option value="">Todos os Layouts</option>
                                <option value="classic">Clássico</option>
                                <option value="immersive">Imersivo</option>
                                <option value="centered">Centralizado</option>
                                <option value="timeline">Linha do Tempo</option>
                                <option value="grid">Grid</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="complexity-filter">
                                <option value="">Todas as Complexidades</option>
                                <option value="simple">Simples</option>
                                <option value="medium">Médio</option>
                                <option value="advanced">Avançado</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="applyTemplateFilters()">
                                <i class="fas fa-filter me-2"></i>Filtrar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Grid de Templates -->
    <div class="row g-4" id="templates-grid">
        <!-- Template 1: Análise de Mercado -->
        <div class="col-lg-4 col-md-6" data-category="story-focused business" data-layout="classic" data-complexity="medium">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/4A90E2/ffffff?text=Análise+de+Mercado" 
                         class="card-img-top" alt="Análise de Mercado">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('market-analysis')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('market-analysis')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge story-focused">História</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Análise de Mercado</h5>
                    <p class="card-text text-muted">Template ideal para análises de mercado com foco em narrativa e dados geográficos.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Texto Longo</span>
                        <span class="badge bg-success me-1">Gráficos</span>
                        <span class="badge bg-info me-1">Mapas</span>
                        <span class="badge bg-warning me-1">Dados</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 2: Linha do Tempo Histórica -->
        <div class="col-lg-4 col-md-6" data-category="story-focused education" data-layout="timeline" data-complexity="advanced">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/8E44AD/ffffff?text=Linha+do+Tempo" 
                         class="card-img-top" alt="Linha do Tempo Histórica">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('historical-timeline')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('historical-timeline')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge story-focused">História</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Linha do Tempo Histórica</h5>
                    <p class="card-text text-muted">Narrativa cronológica com eventos históricos e localizações geográficas.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Timeline</span>
                        <span class="badge bg-success me-1">Eventos</span>
                        <span class="badge bg-info me-1">História</span>
                        <span class="badge bg-warning me-1">Cronologia</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 3: Turismo Interativo -->
        <div class="col-lg-4 col-md-6" data-category="map-focused tourism" data-layout="immersive" data-complexity="medium">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/27AE60/ffffff?text=Turismo+Interativo" 
                         class="card-img-top" alt="Turismo Interativo">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('tourism-interactive')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('tourism-interactive')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge map-focused">Mapa</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Turismo Interativo</h5>
                    <p class="card-text text-muted">Mapa imersivo com pontos turísticos, fotos e informações detalhadas.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Fotos</span>
                        <span class="badge bg-success me-1">Vídeos</span>
                        <span class="badge bg-info me-1">Mapa</span>
                        <span class="badge bg-warning me-1">Turismo</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 4: Análise de Localização -->
        <div class="col-lg-4 col-md-6" data-category="balanced business" data-layout="classic" data-complexity="simple">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/F39C12/ffffff?text=Análise+de+Localização" 
                         class="card-img-top" alt="Análise de Localização">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('location-analysis')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('location-analysis')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge balanced">Equilibrado</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Análise de Localização</h5>
                    <p class="card-text text-muted">Equilíbrio perfeito entre mapa e conteúdo para análises de localização.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Análise</span>
                        <span class="badge bg-success me-1">Localização</span>
                        <span class="badge bg-info me-1">Dados</span>
                        <span class="badge bg-warning me-1">Mapa</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 5: Portfólio de Projetos -->
        <div class="col-lg-4 col-md-6" data-category="map-focused business" data-layout="grid" data-complexity="medium">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/E74C3C/ffffff?text=Portfólio+de+Projetos" 
                         class="card-img-top" alt="Portfólio de Projetos">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('project-portfolio')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('project-portfolio')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge map-focused">Mapa</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Portfólio de Projetos</h5>
                    <p class="card-text text-muted">Apresentação visual de projetos em formato de grid com mapa interativo.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Projetos</span>
                        <span class="badge bg-success me-1">Grid</span>
                        <span class="badge bg-info me-1">Mapa</span>
                        <span class="badge bg-warning me-1">Portfólio</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 6: Guia Educacional -->
        <div class="col-lg-4 col-md-6" data-category="story-focused education" data-layout="classic" data-complexity="simple">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/3498DB/ffffff?text=Guia+Educacional" 
                         class="card-img-top" alt="Guia Educacional">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('educational-guide')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('educational-guide')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge story-focused">História</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Guia Educacional</h5>
                    <p class="card-text text-muted">Template educativo com foco na narrativa e aprendizado geográfico.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Educação</span>
                        <span class="badge bg-success me-1">Narrativa</span>
                        <span class="badge bg-info me-1">Aprendizado</span>
                        <span class="badge bg-warning me-1">Guia</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 7: Análise de Dados -->
        <div class="col-lg-4 col-md-6" data-category="balanced business" data-layout="centered" data-complexity="advanced">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/9B59B6/ffffff?text=Análise+de+Dados" 
                         class="card-img-top" alt="Análise de Dados">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('data-analysis')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('data-analysis')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge balanced">Equilibrado</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Análise de Dados</h5>
                    <p class="card-text text-muted">Template avançado para análise de dados com visualizações interativas.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Dados</span>
                        <span class="badge bg-success me-1">Gráficos</span>
                        <span class="badge bg-info me-1">Análise</span>
                        <span class="badge bg-warning me-1">Interativo</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 8: Roteiro de Viagem -->
        <div class="col-lg-4 col-md-6" data-category="map-focused tourism" data-layout="immersive" data-complexity="medium">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/1ABC9C/ffffff?text=Roteiro+de+Viagem" 
                         class="card-img-top" alt="Roteiro de Viagem">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('travel-route')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('travel-route')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge map-focused">Mapa</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Roteiro de Viagem</h5>
                    <p class="card-text text-muted">Roteiro interativo com mapa imersivo e pontos de interesse.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Roteiro</span>
                        <span class="badge bg-success me-1">Viagem</span>
                        <span class="badge bg-info me-1">Mapa</span>
                        <span class="badge bg-warning me-1">Turismo</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 9: Relatório Corporativo -->
        <div class="col-lg-4 col-md-6" data-category="story-focused business" data-layout="classic" data-complexity="advanced">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/34495E/ffffff?text=Relatório+Corporativo" 
                         class="card-img-top" alt="Relatório Corporativo">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('corporate-report')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('corporate-report')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge story-focused">História</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Relatório Corporativo</h5>
                    <p class="card-text text-muted">Template profissional para relatórios corporativos com dados geográficos.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Corporativo</span>
                        <span class="badge bg-success me-1">Profissional</span>
                        <span class="badge bg-info me-1">Relatório</span>
                        <span class="badge bg-warning me-1">Dados</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template 10: Mapa de Eventos -->
        <div class="col-lg-4 col-md-6" data-category="balanced business" data-layout="grid" data-complexity="simple">
            <div class="template-card card h-100 shadow-sm border-0">
                <div class="template-preview position-relative">
                    <img src="https://via.placeholder.com/400x250/E67E22/ffffff?text=Mapa+de+Eventos" 
                         class="card-img-top" alt="Mapa de Eventos">
                    <div class="template-overlay">
                        <div class="template-actions">
                            <button class="btn btn-light btn-sm me-2" onclick="previewTemplate('events-map')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('events-map')">
                                Usar Template
                            </button>
                        </div>
                    </div>
                    <div class="template-badge balanced">Equilibrado</div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">Mapa de Eventos</h5>
                    <p class="card-text text-muted">Template equilibrado para mapeamento de eventos e atividades.</p>
                    <div class="template-features">
                        <span class="badge bg-primary me-1">Eventos</span>
                        <span class="badge bg-success me-1">Mapa</span>
                        <span class="badge bg-info me-1">Atividades</span>
                        <span class="badge bg-warning me-1">Agenda</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Preview do Template -->
<div class="modal fade" id="templatePreviewModal" tabindex="-1" aria-labelledby="previewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="preview-title">Preview do Template</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="template-preview-content">
                <!-- Conteúdo do preview será carregado aqui -->
                <div class="text-center text-muted">
                    <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                    <p>Carregando preview...</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-primary" id="use-template-btn">
                    <i class="fas fa-rocket me-2"></i>Usar Este Template
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Teste Simples -->
<div class="modal fade" id="testModal" tabindex="-1" aria-labelledby="testModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="testModalLabel">Modal de Teste</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Este é um modal de teste para verificar se o Bootstrap está funcionando.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<link href="{{ url_for('static', filename='css/geographic_report.css') }}" rel="stylesheet">
<link href="{{ url_for('static', filename='css/geographic_report_templates.css') }}" rel="stylesheet">
<script src="{{ url_for('static', filename='js/geographic_report_templates.js') }}"></script>
<script>
// Inicialização da página
document.addEventListener('DOMContentLoaded', function() {
    // O TemplateManager será inicializado automaticamente pelo arquivo JS
    console.log('Página de templates carregada');
});

// Funções removidas - agora gerenciadas pelo TemplateManager

// Funções removidas - agora gerenciadas pelo TemplateManager

// Função removida - agora gerenciada pelo TemplateManager

// Função removida - agora gerenciada pelo TemplateManager
</script>
{% endblock %}
